<!DOCTYPE html>
{% extends "base.html" %}
{% load static %}
<head>

{% block heading %}
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="{% static 'css/index.css' %}" />
<script src="{% static 'js/jquery-1.11.2.js' %}"></script>
<script>
     $(document).ready(function(){
		$("#server_list_form :checkbox").change(function(){
			var $this = $(this);
			if($this.is(':checked')){
				var server_selection = $this.val();
				$.post('/mypy/', {server_details_display_list: server_selection, 
					csrfmiddlewaretoken: '{{ csrf_token }}'}, function(json_response){
					    response_dict = JSON.parse(json_response);
					    var html_response = "<div class='server_class' id='" + $this.val() + "'>" +
						                        "<div class='server_heading'>" + response_dict.server_name + "</div>" + 
						                            "<div class='server_counters_list'>" +
						                                response_dict.test_var +
						                            "</div>" +
						                     "</div>"    
						$("#server_details").prepend(html_response);
						})
					}
			else{
				$("#" + $this.val()).remove();
			}
				});
			});		
			
</script>
<h1>MyPy</h1>
{% endblock %}


</head>

<body>
    {% block body_tag %}
        <input type="button" class="tab" value="General Info" />
        <input type="button" class="tab" value="Connection History" style="left: 16.5vw; width: 10.2vw;" />
        <input type="button" class="tab" value="Current Connections" style="left: 16.2vw; width: 10.6vw;" />
        <input type="button" class="tab" value="InnoDB Cache" style="left: 15.9vw;" />
        <input type="button" class="tab" value="Threads" style="left: 15.6vw;" />
        <input type="button" class="tab" value="Query Cache" style="left: 15.3vw;" />
        <input type="button" class="tab" value="Index usage" style="left: 15vw;" />
        <input type="button" class="tab" value="Statements" style="left: 14.7vw;" />
        <input type="button" class="tab" value="Replication" style="left: 14.4vw;" />
        
        
        <hr>
        {% if server_list %}
    
	        <form action="/mypy/" method="post" id="server_list_form">
                {% csrf_token %}
                <ul id="side_list">
	                {% for server in server_list %}
	                
	                    <li style="padding: 1.5%;">
	                    <input type="checkbox" name="delete_server_checkbox" value="{{server.mysql_server_name}}"/>
	                    {{ server.mysql_server_name }}</li>
	                {% endfor %}
	            </ul>
	            <!--Delete server will call the index view with the checkbox values as the POST request-->
	            <br>
	            <span>
	                <input type="submit" value="Delete" class="btn" name="delete_server" style="width: 5.5vw;">
	        </form>
	        <!--Add server will call the adding_server view-->
	        <form action="/mypy/add_server/" method="post" style="float: left;">
	            {% csrf_token %}
	            <input type="submit" value="Add Server" class="btn">
            </form>
                </span>
        {% endif %}
        <div id="server_details"></div>
    {% endblock %}
</body>

</html>
